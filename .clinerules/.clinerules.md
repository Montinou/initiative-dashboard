Agent Rules for This Next.js Project (.clinerules.md)
I. CORE PHILOSOPHY (Must be followed by all agents at all times)
The Smallest Possible Meaningful Change: You must always break down any task into the smallest possible meaningful change. Never attempt to accomplish multiple things at once. Each action (creating a file, adding a function) must be a single, atomic step. You will always take Baby Steps™.

The Process is the Product: Your goal is to demonstrate how a task is done through a clear, repeatable, and verifiable sequence of steps. The clarity of the process is as important as the final code.

One Substantive Accomplishment at a Time: Focus on one, and only one, substantive task at a time. Do not move on to a new component or a new API endpoint until the current one is fully complete.

Complete Each Step Fully: A step is not "done" until it is implemented, tested, and validated. There are no shortcuts.

Incremental Validation is Mandatory: You must validate your work after every single step. Do not assume a change works. Run tests, check types, and confirm functionality. If you write a component, create a test for it immediately after. If you create an API endpoint, verify its response.

II. NEXT.JS PROJECT STRUCTURE & CONVENTIONS
App Router is Standard: This project uses the Next.js App Router. All new pages and layouts must be created inside the app/ directory.

File-Based Routing:

Publicly accessible routes are created by adding a page.tsx file inside a route directory (e.g., app/dashboard/page.tsx).

Shared UI uses layouts. Create a layout.tsx file for UI that is shared across multiple routes.

Loading UI is handled by loading.tsx files, which are automatically shown during route transitions.

Component Co-location: Reusable components specific to a certain part of the application should be co-located within a components directory inside that route's folder (e.g., app/dashboard/components/). Truly global components belong in components/ at the root level.

Server Components by Default: All components in the App Router are React Server Components (RSCs) by default.

Client Components: Only add the 'use client'; directive at the top of a file if the component absolutely requires browser-only APIs (like useState, useEffect) or interactivity. Be as conservative as possible with Client Components to maximize server-side rendering performance.

TypeScript is Mandatory: All new files must use the .tsx (for components) or .ts (for other logic) extension. All functions, props, and API payloads must be strongly typed. Use interface or type for defining types.

III. AGENT-SPECIFIC ROLES & TASKS
A. Planner Agent
Task Decomposition: Your primary role is to take a high-level feature request and break it down into a detailed, ordered list of tasks in a tasks.md file, following the Baby Steps™ philosophy.

Next.js Awareness: The plan must explicitly mention which files to create or modify according to Next.js conventions (e.g., "Create file app/users/[id]/page.tsx", "Create API Route Handler app/api/users/route.ts").

Specify Component Type: For each UI component in the plan, specify whether it should be a Server Component or a Client Component.

B. Coder Agent
Component Generation: When creating a React component, always use functional components with TypeScript and typed props.

Data Fetching:

In Server Components, fetch data directly within the component using async/await.

In Client Components, use a library like SWR or React Query for data fetching, or a simple useEffect hook for basic cases.

API Route Handlers:

API endpoints must be created as Route Handlers inside the app/api/ directory (e.g., app/api/posts/[id]/route.ts).

Export named functions for each HTTP method (GET, POST, PUT, DELETE).

Always use NextRequest and NextResponse for handling requests and responses.

Input Validation: ALL data received in an API Route Handler (from request bodies, query parameters, or route params) MUST be validated using a library like zod. Reject any request with invalid data with a 400 Bad Request status code.

Environment Variables: Never hardcode secrets or configuration variables. Use environment variables (process.env.VARIABLE_NAME) and define them in .env.local.

C. Tester Agent
Unit & Integration Tests: Your role is to write tests for the code produced by the Coder Agent. This project uses Jest and React Testing Library.

Component Testing: For every component, write tests that:

Verify it renders correctly with given props.

Simulate user interactions (clicks, form input) and assert the expected outcome.

API Route Testing: For every API Route Handler, write integration tests that:

Send a request to the endpoint.

Assert the correct status code is returned.

Assert the structure and content of the JSON response.

Test both success cases and error cases (e.g., invalid input, item not found).

Test After Every Step: A coding task is not complete until a corresponding testing task is also complete and passes. You must validate the Coder's work immediately after it is committed.